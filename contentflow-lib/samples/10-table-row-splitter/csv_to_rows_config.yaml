# CSV to Rows Processing Workflows
#
# Demonstrates various configurations for processing CSV data with TableRowSplitterExecutor

pipelines:
  # Basic workflow: Load CSV and split into rows
  - name: csv_to_rows_basic
    description: "Load CSV data and split into individual row content items"
    
    executors:
      # Step 1: Pass through CSV data (no transformation)
      - id: load_csv
        name: "Load CSV Data"
        type: pass_through
      
      # Step 2: Split CSV into individual rows
      - id: split_rows
        name: "Split CSV into Rows"
        type: table_row_splitter
        settings:
          table_field: "csv_data"
          table_format: "csv"
          has_header: true
          skip_empty_rows: true
          row_id_prefix: "row"
          include_row_index: true
          include_headers: true
          output_format: "dict"
          csv_delimiter: ","
          csv_quotechar: "\""
    
    execution_sequence: [load_csv, split_rows]

  # Filtered workflow: Load CSV and split with filtering
  - name: csv_to_rows_filtered
    description: "Load CSV and split rows with filtering (skip first 2, max 5)"
    
    executors:
      # Step 1: Pass through CSV data
      - id: load_csv
        name: "Load CSV Data"
        type: pass_through
      
      # Step 2: Split CSV with filters
      - id: split_rows_filtered
        name: "Split CSV into Rows (Filtered)"
        type: table_row_splitter
        settings:
          table_field: "csv_data"
          table_format: "csv"
          has_header: true
          skip_empty_rows: true
          start_row: 2          # Skip first 2 data rows (after header)
          max_rows: 5           # Process maximum 5 rows
          row_id_prefix: "filtered_row"
          include_row_index: true
          include_headers: true
          preserve_parent_data: true
          parent_data_fields:
            - "filename"
            - "source"
          output_format: "dict"
    
    execution_sequence: [load_csv, split_rows_filtered]

  # Advanced workflow: CSV with both dict and list output
  - name: csv_to_rows_both_formats
    description: "Split CSV into rows with both dict and list formats"
    
    executors:
      - id: load_csv
        name: "Load CSV Data"
        type: pass_through
      
      - id: split_rows_both
        name: "Split CSV (Dict + List)"
        type: table_row_splitter
        settings:
          table_field: "csv_data"
          table_format: "csv"
          has_header: true
          skip_empty_rows: true
          output_format: "both"    # Include both dict and list
          include_row_index: true
          include_headers: true
    
    execution_sequence: [load_csv, split_rows_both]

  # Workflow with custom delimiter (TSV)
  - name: tsv_to_rows
    description: "Process tab-separated values (TSV) file"
    
    executors:
      - id: load_tsv
        name: "Load TSV Data"
        type: pass_through
      
      - id: split_rows_tsv
        name: "Split TSV into Rows"
        type: table_row_splitter
        settings:
          table_field: "csv_data"
          table_format: "csv"
          has_header: true
          csv_delimiter: "\t"      # Tab delimiter for TSV
          skip_empty_rows: true
          output_format: "dict"
    
    execution_sequence: [load_tsv, split_rows_tsv]